# Commandes avancées

## grep


http://www.linux-france.org/~nquiniou/module_ui/prog_shell/ch13s04.html

## ssh

Pour se connecter à un serveur ou ordinateur à distance nous pouvons utiliser la commande SSH (secure shell)

Comment cela fonctionne:

```
ssh eleve@192.168.1.1
```
On écrit la commande ssh suivi du nom d'utilisateur avec lequel on va se connecter au serveur (utilisateur qui doit exister sur le serveur distant) @ l'adresse IP du serveur distant.

le mot de passe de l'utilisateur sera demandé pour pouvoir se connecter au serveur


## ssh-keygen

Si vous souhaitez, vous connecter à un serveur sans mot de passe vous devez générer un jeu de clés publique et privée que vous devez partager avec le serveur distant.

#### Suivez les étapes suivantes

Lancez la commande suivante:
```
ssh-keygen -t rsa -b 4096
```
Cette commande va vous générer à l'intérieur de votre répertoire courant à l'intérieur du dossier caché `.ssh` deux fichiers `id_rsa` et `id_rsa.pub`

```
/home/eleve/.ssh/id_rsa
/home/eleve/.ssh/id_rsa.pub
```

Le premier fichier `id_rsa` est privé il ne doit pas être partagé et rester sur votre serveur

Le second fichier `id_rsa.pub` est le fichier que vous allez envoyer sur le serveur distant, celui sur lequel vous souhaitez vous connecter sans mot de passe grace à la commande suivante

```
ssh-copy-id -i ~/.ssh/mykey user@host
```

exemple:
Ici, je copie le fichier id_rsa.pub de mon serveur vers le serveur d'Alex

```
ssh-copy-id -i ~/.ssh/id_rsa.pub eleve@192.168.0.107
```

En lançant cette commande, ma clé id_rsa.pub va être ajouté au fichier `~/.ssh/authorized_keys` du serveur d'Alex


## scp

Si vous souhaitez déplacer des fichiers d'un serveur vers un autre serveur vous pouvez utiliser la commande scp (Secure copy protocol)


exemple


Ici on copie un fichier se trouvant sur notre server vers le serveur d'Alex dans le repertoire `/home/eleve`
```
scp fichier.jpg eleve@192.168.0.107:/home/eleve
```
ou


ici on copie un fichier du serveur d'Alex vers le repertoire où l'on vient de lancer la commande
```
scp eleve@192.168.0.107:/home/eleve/fichier.jpg  .
```

## config (./ssh/config)

Si dans votre travail vous êtes amenés à travailler avec pas mal de connexion `ssh` vous pouvez leur créer un alias pour les retenir plus facilement

pour cela, il faut se rendre dans le repertoire caché `.ssh` se trouvant dans votre repertoire courant (exemple `/home/eleve/.ssh/`) arrivé à l'interieur, il faut créer un fichier `config` et y placer la configuration qui va bien exemple

```
Host pc-alex   // l'alias
  HostName 192.168.0.107 // l'adresse ip du serveur distant
  Port 22 // le port ssh par défaut
  User deploy // l'utilisateur du serveur avec lequel on va se connecter
```

maintenant je peux me connecter facilement au pc d'Alex
```
ssh pc-alex
```

au lieu de
```
ssh eleve@192.168.0.107
```
